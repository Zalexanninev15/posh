# Скрипт для отправки всплывающего уведомления на удаленный комьютер через PowerShell (WinRM должен быть настроен)
# https://smsagent.blog/2019/06/11/just-for-fun-send-a-remote-toast-notification/
# https://winitpro.ru/index.php/2018/10/02/uvedomleniya-polzovateley-is-powershell/
# Чтобы отправить сообщение с кастомным изображением, преобразуйте картинку в формат base64 с помощью https://codebeautify.org/image-to-base64-converter и укажите в параметре $Base64Image
# укажите имя компьютера в параметре $RemoteComputer


$Sender = "Admin"
$Message = "Через 15 минут нужно перезапустить клиент 1С"
$RemoteComputer = "msk-pc021"

Function New-ToastNotification {
    Param($Sender,$Message)

    # Required parameters
    $AudioSource = "ms-winsoundevent:Notification.Default"
    $HeaderFormat = "ImageAndTitle" # Choose from "TitleOnly", "ImageOnly" or "ImageAndTitle"
    $Base64Image ="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"


# Create an image file from base64 string and save to user temp location
    If ($Base64Image)
    {
        $ImageFile = "$env:Temp\ToastLogo.png"
        [byte[]]$Bytes = [convert]::FromBase64String($Base64Image)
        [System.IO.File]::WriteAllBytes($ImageFile,$Bytes)
    }
 
    # Load some required namespaces
    $null = [Windows.UI.Notifications.ToastNotificationManager, Windows.UI.Notifications, ContentType = WindowsRuntime]
    $null = [Windows.Data.Xml.Dom.XmlDocument, Windows.Data.Xml.Dom.XmlDocument, ContentType = WindowsRuntime]

    # Register the AppID in the registry for use with the Action Center, if required
    $app =  '{1AC14E77-02E7-4E5D-B744-2EB1AE5198B7}\WindowsPowerShell\v1.0\powershell.exe'
    $AppID = "{1AC14E77-02E7-4E5D-B744-2EB1AE5198B7}\\WindowsPowerShell\\v1.0\\powershell.exe"
    $RegPath = 'HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Notifications\Settings'

    if (!(Test-Path -Path "$RegPath\$AppId")) {
        $null = New-Item -Path "$RegPath\$AppId" -Force
        $null = New-ItemProperty -Path "$RegPath\$AppId" -Name 'ShowInActionCenter' -Value 1 -PropertyType 'DWORD'
    }

# Define the toast notification in XML format
[xml]$ToastTemplate = @"
<toast duration="long">
    <visual>
    <binding template="ToastGeneric">
        <text>$Sender</text> 
        <image placement="appLogoOverride" hint-crop="circle" src="$ImageFile"/>    
        <group>
            <subgroup>
                <text hint-style="title" hint-wrap="true" >$Message</text>
            </subgroup>
        </group>
    </binding>
    </visual>
    <audio src="$AudioSource"/>
</toast>
"@

    # Load the notification into the required format
    $ToastXml = New-Object -TypeName Windows.Data.Xml.Dom.XmlDocument
    $ToastXml.LoadXml($ToastTemplate.OuterXml)

    # Display
    [Windows.UI.Notifications.ToastNotificationManager]::CreateToastNotifier($app).Show($ToastXml)
}

Invoke-Command -ComputerName $RemoteComputer -ScriptBlock ${function:New-ToastNotification} -ArgumentList $Sender,$Message
